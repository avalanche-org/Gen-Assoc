<%- include("./header.ejs")%> 

<div class="col-lg-1 col-md-1 col-xs-1">
          <div class="ui secondary animated button" id="disconnect" tabindex="0" style="margin-top: 40px;">
            <div class="visible content">Exit</div>
            <div class="hidden content">
              <i class="sign-out icon"></i>
            </div>
          </div>
        </div>
      </div> 
    </div>
<div class="container-fluid">
  <div class="row"> 

<div class="ui basic modal segment inverted" style="height:40%; background-color:rgba(244,255,255,0.9) ; border-radius:10px;color:black;">
  <div class="ui icon header inverted"  style="color:black">
    <i class="archive icon "></i>
    Genotype Inference 
  </div>
  <div class="content">
    <p>Do you want to use the new pedfile including inferred Genotypes ? </p>
  </div>
  <div class="actions">
    <div class="ui red  cancel inverted button "  id="gi-modal-no">
      <i class="remove icon"></i>
      No
    </div>
    <div class="ui green ok inverted button" id="gi-modal-yes">
      <i class="checkmark icon"></i>
      Yes
    </div>
  </div>
</div>









    <!--div class="ui  mini modal segment">
          <h5 class="ui teal ribbon floated   label">Genotype Inference</h5>  

<br> 
 <small style="font-family:Maven Pro; font-size:11px;">Do you want to use the new pedfile including inferred Genotypes ? </small> 
<br> 
 <button id="gi-modal-no" class="mini red  inverted ui right floated button">
  No
</button>
<button id="gi-modal-yes" class="mini  teal inverted ui right floated  button">
  Yes 
</button>

    </div-->



<div class="ui basic modal segment inverted" style="height:75%; background-color:rgba(244,255,255,0.9) ; border-radius:10px;color:black;">
  <div class="ui icon header inverted"  style="color:black">
    <i class="chess board icon"></i>
    Parameters selection for the emperical distribution <br>  
  </div>
  <div class="ui content input container"> 
<label > Choose number of permutations:
<br>  
<small  style="font-style:italic;color:gray;"> Indicate  the number of simulations you want  to perform  the run under the Mendelian  Law hypothesis        </small>
</label> 
<br> 
<input type="text" id="nbsim"  placeholder="Number of simulation  exemple 10"  style="font-size:14px;width:20%;"> 
<br> 
<br> 
<label>  Choose number of cores to use: <br>
<small style="font-style:italic;color:gray;">To speed the analysis </small></label><br> 

<select id="nbcores" name="nbcores"  style="font-size:12px;width:80%"  class="ui compact selection  dropdown">
                      <option value = "" disabled selected  >  Number of Cores</option>
        </select> 
  </div>
  <div class="actions">
 <div class="ui green ok inverted button" id="proceed_analysis">
      <i class="checkmark icon"></i>
      Proceed 
    </div>
    <div class="ui red  cancel inverted button"  id="cancel_analysis">
      <i class="remove icon"></i>
      Cancel
    </div>
   
  </div>
</div>


<!-- VALIDITY THRESHOLD  -->  
<div class="ui longer  modal" id="vtmodal" style="height:70%;top:100px">
  <div class="header">Validity Treshold </div>

  <div class="image content">
    <img class="image">


    <div class="description">
      <p id="vt_output"> 

    </p>
   <div class="ui primary  ok  float right inverted button" id="vt_proceed">
      <i class="arrow right icon"></i>
      Proceed
    </div>

    </div>

  </div>
</div>

<!--VALIDITY   TRESHOLD  ADVICE  MODAL --> 

<div class="ui longer  modal"  id="vt_advice" style="height:70%;width:60%;top:100px">
    <h2 class="header ui  blue ribbon label horizontal divider" >Validity of asymptotic theory</h2>

  <div class="image content">
    <img class="image ui piled orange segment"  src="/images/heatmap.png"  style="width:80%; height:80%">


    <div class="description ">
<div  class="ui container teal  segment"> 
        
<h3 class="ui horizontal divider header">Legend </h3> 
<h4> Several Markers : </h4>  

<p class="ui teal mini label">A</p> 
<p class="ui orange mini label">B</p> 
 <p class="ui blue mini label">c</p> 

<h4> Models : Combination of markers </h4> 
<b class="ui teal segment label">A+B </b>  <b class="ui  orange segment label">AxB</b> <b class="ui blue segment label"> A+B+C </b> <b class="ui yellow segment label">AxBxC</b>  ...
</div> 
<div class="ui  container blue segment"> 
        
<h3 class="ui horizontal divider header">Validity  of Asymptotic Theory  </h3> 
<b class="ui  red ribbon label segment ">-></b><b style="font-size:16px"> Empirical  = Asymptotic </b> <br>  
<b class="ui  white ribbon label segment ">-></b>  <b style="font-size:16px">  Empirical   <i class="ban icon"> </i>Asymptotic </b>   
<h4> Important to set if permutations are needed </h4> 
 <ul class="ui list animated "  style="font-size:18px"> 
<li class"ui  tag orange  label">
To save  
 <u> Frequency of the minor allele </u> 
 </li>  
<li>
To reduce  
 <u> Model Complexity </u> 
</li>  
</ul> 

</div>  
<hr>  
<div class="ui tall stacked inverted  segment"> 
<p  class ="ui " style="font-size:20px;" > 
The permutations performed for an empirical analysis can be resource and time consuming. In order to save computational power and reduce program execution time, we compared the distributions of the asymptotic and empirical run by changing the following parameters:
<ul class="ui list animated "  style="font-size:18px"> 
<li class"ui  tag orange  label">
 <p class="ui orange  tag label"  style="font-size:15px"> Frequency of the minor allele </p> 
 </li>  
<li>
 <p class="ui orange  tag label"  style="font-size:15px"> Sample Size </p> 
 </li>  
<li> 
 <p class="ui orange  tag label"  style="font-size:15px"> Model Complexity </p> 
</li>  
</ul> 
<p style="font-size:20px"> The following heat map was generated, allowing to visualise under which conditions an asymptotic run is equivalent to the empirical run. Thus, depending on these same parameters, you will be advised to do an asymptotic run if it is equivalent to the empirical run.</p>  

    </p> 

</div> 
   <div class="ui primary  ok  float right inverted button" id="got_it">
      <i class="thumbs up icon"></i>
      Got It ! 
    </div>

    </div>

  </div>
</div>


<!--END ADVICE ---> 

    <div class="col-md-6">

<div id="carouselExampleIndicators" style="top:60px" class="carousel-dark  carousel slide carousel-fade" data-bs-ride="carousel" data-bs-keyboard="true"> 
  <div class="carousel-indicators">
    <br> 
  </div>
  <div class="carousel-inner">
    <div class="carousel-item  active" >
  
          <h3 class="ui horizontal divider header">Job Title</h3> 
       <div class="container col-8" >   
        <div class="d-block w-100" >  
              <form action="" class="jobTitle_div" id="form1" data-tooltip="Set up new virtual job space" data-inverted=""  data-position="bottom right"> 
            <input type="text" class="jobTitle_field" placeholder="Specify Your Job Title" name="job_title" id="job_title" required />
            <label for="job_title" class="jobTitle_label">Job Title</label> 
            <input type="submit"  id="start_job" class="myBtn myBtn-mtd-color ui small basic teal fluid button " value="GO">
        </form>  
<br>
<br>
<br>
    <div  class="container  col-10"> 
<div class="inline field">   
 <h3>Job Space Setting </h3> </div> 
    <hr>  
        <small> <i class="rocket icon"> </i> 
 <strong>C</strong>reate your virtual workspace in which the analysis will take place. 
The uploaded files as well as the output files will be located in this virtual directory on the server.



    </small>
</div> 

        </div>
 
       </div>
 
    </div>
    
    <div  class="container col-8">  
    <div class="carousel-item" data-bs-interval="1000"> 

          <h3 class="ui horizontal divider header">Upload Files</h3> 

 <% if  ( socket )  {%> 
            <form method="post" action="" enctype="multipart/form-data" name="file_uploader" id="form_upload" class="ui form" style="padding:20px; padding-bottom:0;">
              <div class="ui fluid action input">
                <input name="fupload" type="file" accept=".ped,.map,.phen" multiple style="padding: 20px;border-radius:50px" class="ui input focus"> 
                  <button class="ui brown inverted button" type="submit" id ="files_uploader"  style="border-radius:0px 50px 50px 0px">
                    <div class="hidden content">Upload</div>
                    <div class="visible content">
                      <i class="upload icon"></i>
                    </div>
                  </button>
              </div> 
    <small> *[ Select your files  in : .ped .map .phen formats ] </small>
            </form>
          <%}%>     
<br> 
<br> 
    <div  class="container  col-12"> 
 <h3>Upload Files</h3>
    <hr>  
        <small> <i class="upload icon"></i> <strong>U</strong>pload ped, map, phen files. Make sure your files meets the following requirements:
 
<h4> INPUT FILES FORMAT  </h4>
<ul class="ui list" style="font-size:14px">  
        <li><u> No header in any of the 3 input files </u></li> 
        <li><u> Columns in all input files are tab separated</u></li> 
        <li><u> Three files must have the same basename </u></li> 
    </ul> 



        </small>
</div> 
    </div>
    </div>

    <div class="container col-8">  
    <div class="carousel-item ">
    

          <h3 class="ui horizontal divider header">Summary  Statistics </h3>
<form name="form" style="padding:20px;" class="ui form"> 
            <div class="ui toggle checkbox">
                <input type="checkbox" id="sync" name="sync">
                <label for="sync"><b>Sync</b></label>
            </div>
            <div class="field">
              <label for="ped">Pedigree File</label>
              <select required id="ped" name="ped" class="ui fluid dropdown">
                  <option   value = ""  disabled selected>Select a ped file</option>
              </select>
            </div>
            <div class="field">
              <label for="map">Map file</label>
              <select required id="map" name="map" class="ui fluid dropdown">
                  <option value="" disabled selected>Select a map file</option>
              </select>
            </div>
            <div class="field">
              <label for="phen">Phenotype file</label>
              <select required id="phen" name="phen" class ="ui search dropdown">
                <option value = "" disabled selected > Select a phen file</option>
              </select>
            </div>
            <button type="submit" id ="run_summary" class="ui right  basic teal floated button">Launch Summary Statistics &nbsp;<i class="fas fa-chart-bar"></i></button>
          </form> 
<br> 
    <div  class="container  col-10"> 
 <h3>Summary Statistics</h3>
    <hr>  
        <small> 
<strong> S</strong>elect the files to analyze.

   <br>Enable <div class="ui toggle checkbox">
                <input type="checkbox">
                <label for="sync">Sync</label>
            </div> button, select a file and files with the same basename will automatically complete in the dedicated fields.<br>
Launch Summary Statistics : to view basic information about your data.


        </small>
</div> 
    </div>

</div>

        
     
    <div  class = "container col-8"> 
    <div class="carousel-item">  

          <h3 class="ui horizontal divider header">Genotype Inference</h3>
<form  class="ui form">
            <div class="inline fields">
              <div class="field" style="align-content:center;">
                <!--h4>Retrieve missing genotypes : &nbsp;
                </h4-->
              </div>
              <div class="ui large buttons">
                <button class="ui blue inverted  button"  id="gi-yes">Genotype Inference</button>
                <div class="or"></div>
                <button class="ui button  secondary  inverted "  style="" id ="gi-no">Skip Genotype Inference</button>
              </div>
            </div>
          </form> 


<br> 
<br> 
<br> 
    <div  class="container  col-10"> 
 <h3>Genotype Inference</h3>
    <hr>  
        <small>
M-TDT method is sensitive to missing data. Reduce missingness of your data with genotype inference option which uses mendelian laws to infer genotypes.  


        </small>
</div> 
    </div>
  </div> 




<!---  SINGLE MARKER AND MULTIMAKER  SETTINGS --->  
<div  class = "container col-8"> 
    <div class="carousel-item">  
 
      <h3 class="ui horizontal divider header">Run Type</h3>
      <form class="ui form"> 
            <div class="inline fields">
              <div class="field" style="align-content:center;">
              </div>
              <div class="ui large buttons">
                <button class="ui blue inverted button"  id="single_marker">Single Marker</button>
                <div class="or"></div>
                <button  class="ui button inverted  orange button" id ="multi_marker">Multi Marker</button>
              </div> 
            </div>

 
            <div class="field">  
<div class="ui action input">
  <input type="text" id="marker_set" placeholder="Choose markers. ex 1,2,3,...,">
  <button class="ui primary button" id="validate_markerset" >Validate Selected Markers</button> 
</div>
  <small> *Choose Markers. ex : 1,2,3...</small>
            </div>
         
     </form>

<br> 
<br> 
    <div  class="container  col-10"> 
 <h3>Type of Run  SM or MM  </h3> 
<hr> 
    <hr class="ui teal label">  
        <small>

The 'ped' file can contain several markers, but we advise at the running step to include a limited number of markers, e.g. 3 to 5 in validate selected markers section, to avoid both:
 <ul class="ui list" style="font-size:14px">  
        <li>facing a huge number of alternative hypotheses to test and </li> 
        <li>having sparse count tables for transmitted versus non transmitted alleles combinations across markers.</li> 
    </ul>As discussed in the method paper, MTDT has not been optimized for screen multiple markers effect within a large number of markers, but within a set predefined subgroup of markers of interest, e.g. markers with intermediate marginal effect.
<p class="ui orange label"> Based on the type you selected and your data, you will be advised whether to choose an empirical or theoretical run (next step) </p> 


        </small>
</div> 
    </div> 
  </div>


          <!-- EMPERICAL  ||  THEORICAL --> 
    <div  class= "container col-8"> 
        <div class="carousel-item" >  
          <h3 class="ui horizontal divider header">ANALYSIS</h3>
          <div class="ui  segment basic  ">
            <div class="ui two column very relaxed stackable grid" >
              <div class="column ">
<div class="aligned column"> 
    <br> 
                <div class="ui medium right floated inverted orange  button  e-run">   
                  <i class=" braille icon"></i>
                  EMPIRICAL  ANALYSIS 
                </div>
              </div>

                

              </div>
              <div class="aligned column"> 
    <br> 
                <div class="ui medium left floated inverted blue  button t-run">   
                  <i class="magic icon"></i>
                  THEORETICAL ANALYSIS 
                </div>
              </div>
            </div> 

            <div class="ui vertical divider">
              Or
            </div> 
  

    </div>

         <div  class="container  col-10"> 
 <h3>Theoretical or Empirical </h3>
    <hr>  
        <small> 

The distinction between empirical run and theoretical run is made at this level.<br>
<b> For Empirical test</b> <br><u>Select number of simulations: </u><br>
By default the value of the number of simulations for the calculation of the empirical P-values is 0 and corresponds to the case where only asymptotic P-values are provided. If the sample size is limited or if there is a linkage disequilibrium (LD) between the analyzed markers, the asymptotic theory is no longer valid and the empirical P-values have to be calculated using simulations

<br> <u>Select the number of cores:</u></br>   Only available for simulations. Used to speed up the execution by using multiple cores, as the program can run in parallel at the simulation stage if it is included to obtain empirical P-values.


        </small>
</div>  
        </div> 
   
    </div>  







    <div  class="container col-8"> 
    <div  class="carousel-item"> 
    
        <h3 class="ui horizontal divider header">Run Analysis</h3>  
            <small  style="font-family:Maven Pro;font-size:16px;" class="ui" >  Choose your Phenotype     </small>   
<div class="ui  action input right floated "> 
            <select id="phenotype" name="phenotype" class="ui compact   selection dropdown">
              <option value="" disabled selected></option>
            </select> 
    

</div>  
    <br>
    <br>
            <div id="run_analysis" class="ui right  teal  basic  floated button">Run Analysis &nbsp;<i class="fas fa-dna"></i></div>
    <br>
    <br>
         <div  class="container  col-10"> 
    <hr>  
        <small> 
<b>C</b>hoose your phenotype corresponding to the phenotype column you want to use.



        </small>
</div>  


    </div> 
    </form> 

    </div>

 

</div>







<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">  
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>


</div>








    </div>

    <div class="col-6">

        <div class="div_terminal" style="position: fixed; margin: 8px; margin-top: 0;" >
          <div class="ui inverted menu container fluid"> 
            <div class="item">
              <div class= "ui basic standar  inverted button" id="clear">
                <i class="fas fa-broom" id="clear" title ="clear console"></i>
              </div>
            </div>
            <div class="item">
              <div class="ui basic blue inverted button" id ="infosys">  
                <i class="fas fa-info" id="infosys" title="show system info"></i>
              </div> 
            </div>
            <div class="item"  title="use the terminal  interative mode">
                <div class="ui basic teal inverted button" id="detach_term"> 
              <i class="fas fa-terminal" title="detach terminal"></i>
                m-tdterm  
                </div> 
            </div> 
            <div class="item"  title = "Download  Assets ">
                <div class="ui  basic orange inverted button"  id="download_assets"> 
                    <i class="fa-solid  fa-circle-arrow-down"></i>
                Download  Assets  
                </div> 
            </div> 
            <!--div class="item" title ="Abort  Running Execution  or you Can hit Ctlr+C  to abort ">
                <div class="ui red basic inverted button" style="background-color:#f56f42; color:#59698D;" id="abort_execution"> 
              <i class="fa-solid  fa-ban" title="abort execution"></i>
                Abort execution  
                </div> 
        
            </div-->
            <div class="right menu">
              <div class="item"  id="zoom_out">
                  <i class="fa-solid fa-magnifying-glass-minus"></i>
              </div>
            </div>

            <div class="right menu">
              <div class="item" id="zoom_in">
                  <i class="fa-solid fa-magnifying-glass-plus"></i>
              </div>
            </div>
  <div class="right menu">
              <div class="item ui">
                  <span class="ui dimmer  processing">
    
               <div class="ui mini loader">...</div> 
                </span>
              </div>
            </div>
                      </div>
          <div>
            <!--readonly autocomplete ="off" speelcheck="false" autocapitalize="off"-->
            <textarea name="" id="term" class="terminal"  style="overflow:auto ; height:60%">

</textarea>
  <div class="ui tiny progress">
                <div class="bar step-progress" style="width:10%; background-color:red"></div>
            <div class="label">Tiny</div>
          </div> 
          
        </div>
 
      </div>

    </div>
  
    </div>  <!--row--> 





</div>    <!--container--> 




<%-  include("./footer.ejs")%> 
<%-  include("./scripts/index_jscript.ejs")%>  
